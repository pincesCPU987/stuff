<html>
  <head>
    <title>Convert Binary to Text</title>
  </head>
  <body>
    <textarea id="textarea" style="width:40%;height:90%;"></textarea>
    <textarea readonly id="output" style="width:40%;height:90%;" onclick="this.select();"></textarea>
    <br>
    <input type="button" id="convertToText" value="Convert to text">
    <br>
    <input type="button" id="convertToBinary" value="Convert to binary">
    <script>
      var text = document.querySelector('#textarea');
      var output = document.querySelector('#output');
      text.addEventListener('keydown', function(e) {
        if (e.key == 'Tab') {
          e.preventDefault();
          var start = this.selectionStart;
          var end = this.selectionEnd;

          // set textarea value to: text before caret + tab + text after caret
          this.value = this.value.substring(0, start) +
            "\t" + this.value.substring(end);

          // put caret at right position again
          this.selectionStart =
            this.selectionEnd = start + 1;
        }
      });
      var hex = {
        '0000':'0',
        '0001':'1',
        '0010':'2',
        '0011':'3',
        '0100':'4',
        '0101':'5',
        '0110':'6',
        '0111':'7',
        '1000':'8',
        '1001':'9',
        '1010':'a',
        '1011':'b',
        '1100':'c',
        '1101':'d',
        '1110':'e',
        '1111':'f'
      }
      function byteString(n) {
        if (n < 0 || n > 255 || n % 1 !== 0) {
            throw new Error(n + " does not fit in a byte");
        }
        return ("000000000" + n.toString(2)).substr(-8)
      }
      document.querySelector('#convertToText').addEventListener('click',function(){
        var str = '';
        var spl = text.value.split(' ');
        var byte1;
        var byte2;
        if(spl.length > 0){
          try {
            for(var i = 0; i < spl.length; i++){
              byte1 = spl[i].split('')[0] + spl[i].split('')[1] + spl[i].split('')[2] + spl[i].split('')[3]
              byte2 = spl[i].split('')[4] + spl[i].split('')[5] + spl[i].split('')[6] + spl[i].split('')[7]
              if(spl[i].length > 0){
              	str = str + String.fromCharCode(eval('0x' + hex[byte1] + hex[byte2] + ' '));
              }
            }
          } catch(err){
          	str = 'Error in binary code. Check that:\n\tIt isn\'t text.\n\tThere are spaces in between.\nCheck your binary for non-8-bit codes and/or text.'
          }
        }
        output.value = str;
      });
      document.querySelector('#convertToBinary').addEventListener('click',function(){
      	var str = '';
        var spl = text.value.split('');
        var code;
        var byte1;
        var byte2;
        for(var i = 0; i < spl.length; i++){
        	code = byteString(spl[i].charCodeAt(0));
        	str = str + code + ' ';
        }
        output.value = str
      })
    </script>
  </body>
</html>
